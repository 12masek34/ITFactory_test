# ITFactory_test

## ТЗ
Создать простое API для мобильного приложения, в котором полевой сотрудник заказчика будет выполнять визиты в магазины.
### Создать сущности
1. ### "Работник":
* имя – char 255
* номер телефона – char 255
2. ### "Торговая точка"
* название
* ForeignKey к "Работник" (обязательно к заполнению) 
3. ### "Посещение"
* дата/время
* ForeignKey к "Торговая точка"
* latitude – float
* longitude – float
### Сделать методы
Для упрощения задания, вместо полноценной авторизации передавать в каждый запрос номер телефона Работника.
1. Получить список торговых точек привязанных к переданному номеру телефона.В ответе:
* список торговых точек (PK Название)
2. Выполнить посещение в торговую точку. Принимает:
* PK Торговой точки и координаты

В ответе:
* PK Посещения Дата/время

Проверять, что переданный номер телефона Работника привязан к
указанной ТТ, в противном случае возвращать ошибку.

При создании Посещения в дата/время сохранить текущие дату/время

### Админка
* Работник

создание, редактирование, удаление, поиск по имени   

* Торговая точка

создание, редактирование, удаление, поиск по названию

* Посещение

просмотр, поиск по имени Работника, поиск по названию Торговой точки

---
 ## install

python3.10 -m venv venv  создаем виртуальное окружение.

source venv/bin/activate  активируем виртуальное окружение.

pip install -r requriments.txt  устанавливаем зависимости.

Запускаем локальный сервер postgres.

В корне проекта, в фаиле  .env прописываем настройки бд. DB_NAME = имя бд DB_USER = логин DB_PASSWORD = пароль.

python manage.py makemigrations  создаем миграции.

python manage.py migrate  применяем миграции.

python manage.py loaddata worker.json  загружаем тестовые данные в бд.

python manage.py loaddata salepoint.json  загружаем тестовые данные в бд.

---

Run.

python manage.py runserver

---

## routes

### По всем маршрутам, для авторизации, в headers надо передать ключ phone со значением любого номера телефона из бд (например +79615339876)

http://127.0.0.1:8000/swagger-ui/  документация.

http://127.0.0.1:8000/salepoints/  метод get. Возвращает список торговых точек, привязаных к переданому номеру телефона.

http://127.0.0.1:8000/visit/  метод post. Принимает тело {"sale_point": int, "latitude": float, "longitude": float}.Создает запись визита в бд. Возвращает {"id": int, "visit_date": "DateTime"} визита. При условии что номер телефона принадлежит точки продажи.









